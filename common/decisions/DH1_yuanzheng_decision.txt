#If you change the values loc for NSB_border_incident_delay_until_new_incident_180 and NSB_border_incident_delay_until_new_incident_120 has to be changed
@border_incident_escalation_countdown = 5
@border_conflict_incident_forgotten_timer = 30
@border_conflict_escalate_to_war_countdown = 45
@border_conflict_time_until_cancelled = 360
# Using BCE values for AI

DH1_yuanzheng_decision_category = {
	DH1_yuanzheng_mission = {
		icon = border_war		

		available = {
			FROM = {
				any_owned_state = {
					is_controlled_by = FROM
					OR = {
						AND = {
							OR = {
								PREV = { has_completed_focus = DH1_zhongnanbandao }
								is_debug = yes
							}
							OR = {
								is_core_of = BRM
								is_core_of = VIN
								is_core_of = LAO
								is_core_of = SIA
								is_core_of = MAL
							}
						}
						AND = {
							OR = {
								PREV = { has_completed_focus = DH1_nanyacidalu }
								is_debug = yes
							}
							OR = {
								is_core_of = RAJ
								is_core_of = PAK
								is_core_of = BAN
								state = 320
								state = 321
							}
						}
					}
					any_neighbor_state = {
						is_fully_controlled_by = ROOT
						set_temp_variable = { var:attacker_state_temp = id }
						has_ROOT_at_least_1_div_in_current_state_scope = yes
						hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
					}
					NOT = { has_state_flag = border_incident_active }
					set_temp_variable = { var:defender_state_temp = id }
				}
			}
			# NOT = { has_non_aggression_pact_with = FROM }
			# NOT = { gives_military_access_to = FROM }
			# NOT = { has_military_access_to = FROM }
		}

		visible = {
			FROM = {
				any_owned_state = {
					OR = {
						AND = {
							OR = {
								PREV = { has_completed_focus = DH1_zhongnanbandao }
								is_debug = yes
							}
							OR = {
								is_core_of = BRM
								is_core_of = VIN
								is_core_of = LAO
								is_core_of = SIA
								is_core_of = MAL
							}
						}
						AND = {
							OR = {
								PREV = { has_completed_focus = DH1_nanyacidalu }
								is_debug = yes
							}
							OR = {
								is_core_of = RAJ
								is_core_of = PAK
								is_core_of = BAN
								state = 320
								state = 321
							}
						}
					}
				}
			}
			OR = {
				AND = {
					tag = DH1
					is_debug = yes
				}
				AND = {
					tag = DH1
					FROM = { exists = yes }
					NOT = { 
						AND = {
							has_war_with = FROM 
							is_ai = yes
						}
					}
					FROM = { has_not_initiated_border_incident_with_ROOT = yes }
					FROM = {
						NOT = {
							is_subject_of = ROOT
						}
						NOT = {
							is_in_faction_with = ROOT
						}
					}
					NOT = {
						is_subject_of = FROM
					}
		
					OR = {
						NOT = { has_border_war_with = FROM }
						FROM = {
							any_owned_state = {
								is_controlled_by = FROM
								hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
								any_neighbor_state = {
									hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
									is_fully_controlled_by = ROOT
								}
							}
						}
					}
				}
			}
		}

		# VPI by Yard1

			target_trigger = {
				exists = yes
			}
		target_array = neighbors


				target_trigger = {
			FROM = {
				exists = yes }
				}

		highlight_states = {
			highlight_states_trigger = {
				OR = {
					state = FROM.defender_state_vs_@ROOT
					AND = {
						is_owned_and_controlled_by = FROM
						hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
						any_neighbor_state = {
							hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
							has_ROOT_at_least_1_div_in_current_state_scope = yes
							is_fully_controlled_by = ROOT
						}
					}
				}
			}
		}
		ai_will_do = { 
			base = 0.2
			
			modifier = {
				ROOT = { strength_ratio = { tag = FROM ratio < 0.5 } }
				
				factor = 0
			}
		}

		cost = 30


		fire_only_once = no

		days_remove = @border_incident_escalation_countdown
		days_re_enable = 60

		war_with_target_on_remove = yes

		complete_effect = {
			hidden_effect = {
				FROM = {
					random_owned_controlled_state = {
						limit = {
							hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
							any_neighbor_state = {
								hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
								has_ROOT_at_least_1_div_in_current_state_scope = yes
								is_fully_controlled_by = ROOT
							}
						}
						save_event_target_as = defender_state
						set_variable = { FROM.defender_state_vs_@ROOT = id }
						set_temp_variable = { defender_state_temp = id }
						set_state_flag = border_incident_active
					}
				}
				random_state = {
					limit = {
						is_fully_controlled_by = ROOT
						hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
						has_ROOT_at_least_1_div_in_current_state_scope = yes
						any_neighbor_state = {
							state = var:FROM.defender_state_vs_@ROOT
						}
					}
					save_event_target_as = attacker_state
					set_variable = { FROM.attacker_state_vs_@ROOT = id }
					set_temp_variable = { attacker_state_temp = id }
					set_state_flag = border_incident_active
				}
			}
			
		}
		remove_effect = {
			start_border_war = {
				change_state_after_war = yes
				attacker = {
					state = var:FROM.attacker_state_vs_@ROOT
					num_provinces = 4
					on_win = DH1_yuanzheng_border_conflict.2
					on_lose = DH1_yuanzheng_border_conflict.3
					on_cancel = DH1_yuanzheng_border_conflict.4
				}	
				defender = {
					state = var:FROM.defender_state_vs_@ROOT
					num_provinces = 4
					on_win = DH1_yuanzheng_border_conflict.3
					on_lose = DH1_yuanzheng_border_conflict.2
					on_cancel = DH1_yuanzheng_border_conflict.4
				}
			}
			hidden_effect = {
				var:FROM.defender_state_vs_@ROOT = {
					save_event_target_as = defender_state 
				}
				var:FROM.attacker_state_vs_@ROOT = {
					save_event_target_as = attacker_state 
				}
				FROM = {
					random_owned_controlled_state = {
						limit = {
							hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
							any_neighbor_state = {
								is_fully_controlled_by = ROOT
								has_ROOT_at_least_1_div_in_current_state_scope = yes
								hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
							}
						}
						set_temp_variable = { defender_state_temp = id }
					}
				}
				random_state = {
					limit = {
						is_fully_controlled_by = ROOT
						hidden_trigger = { NOT = { has_state_flag = border_incident_active } }
						has_ROOT_at_least_1_div_in_current_state_scope = yes
						any_neighbor_state = {
							state = var:FROM.defender_state_vs_@ROOT
						}
					}
					set_temp_variable = { attacker_state_temp = id }
				}
			}
		}
	}
}